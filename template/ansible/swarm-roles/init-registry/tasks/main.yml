---
- name: Create Directory
  shell: mkdir -p /etc/docker/certs.d/{{ domain_name }}:5000

- name: Copy Certificate
  shell: cp /etc/ssl/private/{{ domain_name }}.csr  /etc/docker/certs.d/{{ domain_name }}:5000/ca.crt

- name: Change Host File
  shell: sh -c "echo ' {{ hostvars['manager']['ansible_default_ipv4']['address'] }} {{ domain_name }}' >> /etc/hosts"

- name: Change Daemon File
  shell: sh -c "echo '{ \n  \"insecure-registries\":[\"{{domain_name}}:5000\"] \n}'  > /etc/docker/daemon.json"

- name: Change Resolve Config
  shell: sh -c "echo '{{domain_name}} {{hostvars['manager']['ansible_default_ipv4']['address']}}' >> /etc/resolv.conf"