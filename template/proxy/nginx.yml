nginx-proxy:
  image: jwilder/nginx-proxy:latest
  deploy:
    replicas: 1
    placement:
      constraints:
        - node.role == manager
  ports:
    - target: 80
      published: 80
      protocol: tcp
      mode: host
    - target: 443
      published: 443
      protocol: tcp
      mode: host
  volumes:
    - ./nginx.conf:/etc/nginx/nginx.conf
    - /var/run/docker.sock:/tmp/docker.sock:ro
    - ./proxy/certs:/etc/nginx/certs:ro
    - ./proxy/vhost.d:/etc/nginx/vhost.d
    - ./proxy/html:/usr/share/nginx/html
  labels:
    com.github.jrcs.letsencrypt_nginx_proxy_companion.nginx_proxy: ""

nginx:
  image: jrcs/letsencrypt-nginx-proxy-companion:latest
  deploy:
    replicas: 1
    placement:
      constraints:
        - node.role == manager
  volumes:
    - ./nginx.conf:/etc/nginx/nginx.conf
    - /var/run/docker.sock:/var/run/docker.sock:ro
    - ./proxy/certs:/etc/nginx/certs
    - ./proxy/vhost.d:/etc/nginx/vhost.d
    - ./proxy/html:/usr/share/nginx/html
